<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Wings - æ¢ç´¢ç³»çµ±æ¸¬è©¦</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/screens/exploration-hud.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #1a1a2e;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }

        #game-container {
            width: 100vw;
            height: 100vh;
        }

        .exploration-screen {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #exploration-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 100%);
        }

        .exploration-hud {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .exploration-hud > * {
            pointer-events: auto;
        }

        .hud-top-left {
            position: absolute;
            top: 20px;
            left: 20px;
        }

        .hud-top-right {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .hud-bottom-center {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .hud-bottom-right {
            position: absolute;
            bottom: 20px;
            right: 20px;
        }

        .interaction-hint {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hint-key {
            background: #FFD700;
            color: #000;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
        }

        .pause-menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .pause-content {
            background: #2a2a4a;
            padding: 40px;
            border-radius: 16px;
            text-align: center;
        }

        .pause-content h2 {
            margin-bottom: 20px;
        }

        .pause-content button {
            display: block;
            width: 200px;
            margin: 10px auto;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-secondary {
            background: #666;
            color: white;
        }

        .hidden {
            display: none !important;
        }

        /* æ¸¬è©¦æ§åˆ¶é¢æ¿ */
        .test-controls {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 2000;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .test-controls button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .test-controls .test-info {
            color: #aaa;
            font-size: 12px;
        }

        /* è¼‰å…¥ç•«é¢ */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a2e;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #333;
            border-top-color: #FFD700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <!-- è¼‰å…¥ç•«é¢ -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">è¼‰å…¥æ¢ç´¢ç³»çµ±...</div>
    </div>

    <!-- æ¸¬è©¦æ§åˆ¶é¢æ¿ -->
    <div class="test-controls" id="test-controls" style="display: none;">
        <span class="test-info">æ¢ç´¢ç³»çµ±æ¸¬è©¦</span>
        <button onclick="testAddNPC()">+ NPC</button>
        <button onclick="testAddItem()">+ ç‰©å“</button>
        <button onclick="testCallPartner()">å‘¼å«å¤¥ä¼´</button>
        <button onclick="testUseAbility()">ä½¿ç”¨èƒ½åŠ›</button>
        <button onclick="testShowDialogue()">æ¸¬è©¦å°è©±</button>
        <button onclick="testCompleteMission()">å®Œæˆä»»å‹™</button>
    </div>

    <!-- éŠæˆ²å®¹å™¨ -->
    <div id="game-container"></div>

    <!-- æ ¸å¿ƒè…³æœ¬ -->
    <script type="module">
        // ç°¡åŒ–çš„ eventBus
        window.eventBus = {
            listeners: {},
            on(event, callback) {
                if (!this.listeners[event]) this.listeners[event] = [];
                this.listeners[event].push(callback);
            },
            off(event, callback) {
                if (this.listeners[event]) {
                    this.listeners[event] = this.listeners[event].filter(cb => cb !== callback);
                }
            },
            emit(event, data) {
                console.log(`[Event] ${event}`, data);
                if (this.listeners[event]) {
                    this.listeners[event].forEach(cb => cb(data));
                }
            }
        };

        // ç°¡åŒ–çš„ gameState
        window.gameState = {
            money: 1000,
            characters: {
                jett: { id: 'jett', name: 'Jett', isAvailable: true, level: 5 },
                donnie: { id: 'donnie', name: 'Donnie', isAvailable: true, level: 3 },
                todd: { id: 'todd', name: 'Todd', isAvailable: true, level: 2 },
                chase: { id: 'chase', name: 'Chase', isAvailable: true, level: 4 },
                bello: { id: 'bello', name: 'Bello', isAvailable: true, level: 2 },
                paul: { id: 'paul', name: 'Paul', isAvailable: true, level: 3 },
                flip: { id: 'flip', name: 'Flip', isAvailable: true, level: 2 },
                jerome: { id: 'jerome', name: 'Jerome', isAvailable: true, level: 3 }
            },
            getCharacter(id) {
                return this.characters[id] || this.characters.jett;
            },
            addMoney(amount) {
                this.money += amount;
                console.log(`Money: ${this.money}`);
            },
            addExp(amount) {
                console.log(`Added ${amount} EXP`);
            }
        };

        // ç°¡åŒ–çš„ CONFIG
        window.CONFIG = {
            PATHS: {
                CHARACTERS: 'assets/images/characters',
                NPCS: 'assets/images/npcs',
                ITEMS: 'assets/images/items',
                BACKGROUNDS: 'assets/images/backgrounds'
            }
        };

        // æ¸¬è©¦ç”¨çš„æ¢ç´¢ç³»çµ±
        class TestExplorationSystem {
            constructor(container) {
                this.container = container;
                this.canvas = null;
                this.ctx = null;
                this.entities = [];
                this.player = null;
                this.isRunning = false;
                this.keys = {};

                // éŠæˆ²ç‹€æ…‹
                this.cameraX = 0;
                this.groundY = 500;
            }

            init() {
                this.createDOM();
                this.setupInput();
                this.createPlayer();
                this.createTestEntities();
                this.start();
            }

            createDOM() {
                this.container.innerHTML = `
                    <div class="exploration-screen">
                        <canvas id="exploration-canvas"></canvas>

                        <div class="exploration-hud">
                            <div class="hud-top-left" id="mission-tracker-container">
                                <div class="mission-tracker">
                                    <div class="tracker-header">
                                        <span>ğŸ“‹ ä»»å‹™ç›®æ¨™</span>
                                    </div>
                                    <div class="tracker-body">
                                        <h3>æ­¡è¿ä¾†åˆ°å·´é»ï¼</h3>
                                        <div class="task-list">
                                            <div class="task-item active">
                                                <span>ğŸ”µ</span> èˆ‡ Maria å°è©±
                                            </div>
                                            <div class="task-item pending">
                                                <span>âšª</span> æ‰¾åˆ°çƒ˜ç„™ææ–™
                                            </div>
                                            <div class="task-item pending">
                                                <span>âšª</span> æ¢ç´¢å’–å•¡å»³
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="hud-top-right" id="partner-switcher-container">
                                <div class="partner-switcher">
                                    <div class="active-partners">
                                        <div class="partner-slot active" title="Jett (ä½ )">
                                            <div class="partner-avatar">âœˆï¸</div>
                                            <span>Jett</span>
                                        </div>
                                    </div>
                                    <button class="call-partner-btn" onclick="testCallPartner()">
                                        ğŸ“ å‘¼å«å¤¥ä¼´
                                    </button>
                                </div>
                            </div>

                            <div class="hud-bottom-center" id="inventory-bar-container">
                                <div class="inventory-bar">
                                    ${[1,2,3,4,5,6,7,8,9,0].map(i => `
                                        <div class="inventory-slot" data-slot="${i}">
                                            <span class="slot-number">${i}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>

                            <div class="hud-bottom-right" id="ability-bar-container">
                                <div class="ability-bar">
                                    <div class="ability-slot" data-key="Q">
                                        <span class="ability-icon">âš¡</span>
                                        <span class="ability-key">Q</span>
                                        <span class="ability-name">è¶…é€Ÿé…é€</span>
                                    </div>
                                    <div class="ability-slot" data-key="W">
                                        <span class="ability-icon">ğŸ“</span>
                                        <span class="ability-key">W</span>
                                        <span class="ability-name">å¬å–šå¤¥ä¼´</span>
                                    </div>
                                </div>
                            </div>

                            <div class="interaction-hint hidden" id="interaction-hint">
                                <span class="hint-key">E</span>
                                <span class="hint-text">äº’å‹•</span>
                            </div>
                        </div>

                        <div class="pause-menu hidden" id="pause-menu">
                            <div class="pause-content">
                                <h2>æš«åœ</h2>
                                <button class="btn-primary" onclick="window.testSystem.resume()">ç¹¼çºŒ</button>
                                <button class="btn-secondary" onclick="location.reload()">é‡æ–°é–‹å§‹</button>
                            </div>
                        </div>
                    </div>
                `;

                this.canvas = document.getElementById('exploration-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.fitCanvas();
                window.addEventListener('resize', () => this.fitCanvas());
            }

            fitCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
                this.groundY = this.canvas.height - 150;
            }

            setupInput() {
                document.addEventListener('keydown', (e) => {
                    this.keys[e.key.toLowerCase()] = true;
                    if (e.key === 'Escape') this.togglePause();
                    if (e.key === 'e' || e.key === 'E') this.tryInteract();
                    if (e.key === 'q' || e.key === 'Q') this.useAbility(0);
                    if (e.key === 'w' || e.key === 'W') this.useAbility(1);
                });
                document.addEventListener('keyup', (e) => {
                    this.keys[e.key.toLowerCase()] = false;
                });
            }

            createPlayer() {
                this.player = {
                    x: 200,
                    y: this.groundY,
                    width: 80,
                    height: 120,
                    vx: 0,
                    vy: 0,
                    speed: 300,
                    isFlying: false,
                    facingRight: true,
                    color: '#FF6B6B'
                };
            }

            createTestEntities() {
                // æ¸¬è©¦ NPC
                this.entities.push({
                    type: 'npc',
                    id: 'maria',
                    name: 'Maria',
                    x: 500,
                    y: this.groundY,
                    width: 60,
                    height: 100,
                    color: '#9B59B6',
                    canInteract: true,
                    dialogue: 'ä½ å¥½ï¼æ­¡è¿ä¾†åˆ°å·´é»ï¼'
                });

                // æ¸¬è©¦ç‰©å“
                this.entities.push({
                    type: 'item',
                    id: 'croissant',
                    name: 'å¯é ŒéºµåŒ…',
                    x: 800,
                    y: this.groundY + 40,
                    width: 40,
                    height: 40,
                    color: '#F39C12',
                    canPickup: true
                });

                // æ¸¬è©¦å»ºç¯‰å…¥å£
                this.entities.push({
                    type: 'building',
                    id: 'cafe',
                    name: 'å’–å•¡å»³',
                    x: 1200,
                    y: this.groundY - 150,
                    width: 200,
                    height: 200,
                    color: '#8B4513',
                    canEnter: true
                });
            }

            start() {
                this.isRunning = true;
                this.lastTime = performance.now();
                this.gameLoop();
            }

            gameLoop() {
                if (!this.isRunning) return;

                const now = performance.now();
                const dt = (now - this.lastTime) / 1000;
                this.lastTime = now;

                if (!this.isPaused) {
                    this.update(dt);
                    this.render();
                }

                requestAnimationFrame(() => this.gameLoop());
            }

            update(dt) {
                // ç©å®¶ç§»å‹•
                let moveX = 0;
                let moveY = 0;

                if (this.keys['a'] || this.keys['arrowleft']) moveX = -1;
                if (this.keys['d'] || this.keys['arrowright']) moveX = 1;
                if (this.keys['w'] || this.keys['arrowup']) moveY = -1;
                if (this.keys['s'] || this.keys['arrowdown']) moveY = 1;

                // é£›è¡Œæ¨¡å¼ (æŒ‰ä½ Space)
                if (this.keys[' ']) {
                    this.player.isFlying = true;
                } else if (this.player.y >= this.groundY) {
                    this.player.isFlying = false;
                }

                // é€Ÿåº¦
                const speed = this.player.isFlying ? 400 : 300;
                this.player.vx = moveX * speed;

                if (this.player.isFlying) {
                    this.player.vy = moveY * speed;
                } else {
                    // é‡åŠ›
                    this.player.vy += 800 * dt;
                }

                // ä½ç½®æ›´æ–°
                this.player.x += this.player.vx * dt;
                this.player.y += this.player.vy * dt;

                // åœ°é¢ç¢°æ’
                if (this.player.y > this.groundY) {
                    this.player.y = this.groundY;
                    this.player.vy = 0;
                }

                // å¤©èŠ±æ¿
                if (this.player.y < 50) {
                    this.player.y = 50;
                }

                // æœå‘
                if (moveX > 0) this.player.facingRight = true;
                if (moveX < 0) this.player.facingRight = false;

                // æ”å½±æ©Ÿè·Ÿéš¨
                this.cameraX = this.player.x - this.canvas.width / 2;

                // æª¢æŸ¥äº’å‹•
                this.checkInteraction();
            }

            render() {
                const ctx = this.ctx;
                ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // èƒŒæ™¯
                const gradient = ctx.createLinearGradient(0, 0, 0, this.canvas.height);
                gradient.addColorStop(0, '#87CEEB');
                gradient.addColorStop(1, '#E0F6FF');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

                // èƒŒæ™¯å»ºç¯‰ï¼ˆè¦–å·®ï¼‰
                ctx.fillStyle = '#DDD';
                for (let i = 0; i < 10; i++) {
                    const x = (i * 300 - this.cameraX * 0.3) % (this.canvas.width + 300) - 150;
                    const h = 100 + Math.sin(i) * 50;
                    ctx.fillRect(x, this.groundY - h, 80, h);
                }

                // åœ°é¢
                ctx.fillStyle = '#7CB342';
                ctx.fillRect(0, this.groundY + 50, this.canvas.width, 100);

                // è·¯é¢
                ctx.fillStyle = '#8D6E63';
                ctx.fillRect(0, this.groundY + 50, this.canvas.width, 30);

                // å¯¦é«”
                ctx.save();
                ctx.translate(-this.cameraX, 0);

                // æ¸²æŸ“å»ºç¯‰
                this.entities.filter(e => e.type === 'building').forEach(e => {
                    ctx.fillStyle = e.color;
                    ctx.fillRect(e.x, e.y, e.width, e.height);
                    // é–€
                    ctx.fillStyle = '#5D4037';
                    ctx.fillRect(e.x + e.width/2 - 20, e.y + e.height - 60, 40, 60);
                    // æ¨™ç±¤
                    ctx.fillStyle = '#FFF';
                    ctx.font = '14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(e.name, e.x + e.width/2, e.y - 10);
                });

                // æ¸²æŸ“ NPC
                this.entities.filter(e => e.type === 'npc').forEach(e => {
                    // èº«é«”
                    ctx.fillStyle = e.color;
                    ctx.fillRect(e.x - e.width/2, e.y - e.height, e.width, e.height);
                    // é ­
                    ctx.beginPath();
                    ctx.arc(e.x, e.y - e.height - 20, 25, 0, Math.PI * 2);
                    ctx.fill();
                    // åå­—
                    ctx.fillStyle = '#FFF';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(e.name, e.x, e.y - e.height - 55);

                    // äº’å‹•æç¤º
                    if (e.isNearPlayer) {
                        ctx.fillStyle = '#FFD700';
                        ctx.font = '24px Arial';
                        ctx.fillText('!', e.x, e.y - e.height - 80);
                    }
                });

                // æ¸²æŸ“ç‰©å“
                this.entities.filter(e => e.type === 'item').forEach(e => {
                    ctx.fillStyle = e.color;
                    ctx.beginPath();
                    ctx.arc(e.x, e.y, e.width/2, 0, Math.PI * 2);
                    ctx.fill();
                    // ç™¼å…‰æ•ˆæœ
                    ctx.strokeStyle = 'rgba(255, 215, 0, 0.5)';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                });

                // æ¸²æŸ“ç©å®¶
                ctx.fillStyle = this.player.color;
                const px = this.player.x - this.player.width/2;
                const py = this.player.y - this.player.height;
                ctx.fillRect(px, py, this.player.width, this.player.height);

                // ç©å®¶é ­
                ctx.beginPath();
                ctx.arc(this.player.x, py - 20, 30, 0, Math.PI * 2);
                ctx.fill();

                // é£›è¡Œæ™‚çš„ç¿…è†€æ•ˆæœ
                if (this.player.isFlying) {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                    ctx.beginPath();
                    ctx.ellipse(this.player.x - 50, py + 30, 30, 15, -0.3, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.beginPath();
                    ctx.ellipse(this.player.x + 50, py + 30, 30, 15, 0.3, 0, Math.PI * 2);
                    ctx.fill();
                }

                // åå­—
                ctx.fillStyle = '#FFF';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Jett', this.player.x, py - 60);

                ctx.restore();

                // æ§åˆ¶æç¤º
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(10, this.canvas.height - 80, 300, 70);
                ctx.fillStyle = '#FFF';
                ctx.font = '14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText('WASD/æ–¹å‘éµ: ç§»å‹•', 20, this.canvas.height - 55);
                ctx.fillText('Space (æŒ‰ä½): é£›è¡Œ', 20, this.canvas.height - 35);
                ctx.fillText('E: äº’å‹• | Q/W: èƒ½åŠ› | ESC: æš«åœ', 20, this.canvas.height - 15);
            }

            checkInteraction() {
                const hint = document.getElementById('interaction-hint');
                const hintText = hint.querySelector('.hint-text');
                let foundTarget = false;

                this.entities.forEach(e => {
                    const dist = Math.abs(this.player.x - e.x);
                    e.isNearPlayer = dist < 100;

                    if (e.isNearPlayer && (e.canInteract || e.canPickup || e.canEnter)) {
                        foundTarget = true;
                        if (e.type === 'npc') {
                            hintText.textContent = `èˆ‡ ${e.name} å°è©±`;
                        } else if (e.type === 'item') {
                            hintText.textContent = `æ’¿å– ${e.name}`;
                        } else if (e.type === 'building') {
                            hintText.textContent = `é€²å…¥ ${e.name}`;
                        }
                        this.currentTarget = e;
                    }
                });

                if (foundTarget) {
                    hint.classList.remove('hidden');
                } else {
                    hint.classList.add('hidden');
                    this.currentTarget = null;
                }
            }

            tryInteract() {
                if (!this.currentTarget) return;

                const e = this.currentTarget;
                if (e.type === 'npc') {
                    alert(`${e.name}: ${e.dialogue}`);
                } else if (e.type === 'item') {
                    alert(`ç²å¾—: ${e.name}ï¼`);
                    // æ·»åŠ åˆ°ç‰©å“æ¬„
                    const slots = document.querySelectorAll('.inventory-slot');
                    for (let slot of slots) {
                        if (!slot.querySelector('.item-icon')) {
                            slot.innerHTML += `<span class="item-icon" style="font-size:24px;">ğŸ¥</span>`;
                            break;
                        }
                    }
                    // ç§»é™¤ç‰©å“
                    this.entities = this.entities.filter(en => en !== e);
                } else if (e.type === 'building') {
                    alert(`é€²å…¥ ${e.name}...ï¼ˆå ´æ™¯åˆ‡æ›åŠŸèƒ½å¾…å¯¦ä½œï¼‰`);
                }
            }

            useAbility(index) {
                const abilities = ['è¶…é€Ÿé…é€', 'å¬å–šå¤¥ä¼´'];
                alert(`ä½¿ç”¨èƒ½åŠ›: ${abilities[index]}`);
            }

            togglePause() {
                this.isPaused = !this.isPaused;
                const menu = document.getElementById('pause-menu');
                if (this.isPaused) {
                    menu.classList.remove('hidden');
                } else {
                    menu.classList.add('hidden');
                }
            }

            resume() {
                this.isPaused = false;
                document.getElementById('pause-menu').classList.add('hidden');
            }
        }

        // æ¸¬è©¦å‡½æ•¸
        window.testAddNPC = function() {
            const npc = {
                type: 'npc',
                id: 'test_npc_' + Date.now(),
                name: 'æ¸¬è©¦ NPC',
                x: window.testSystem.player.x + 200,
                y: window.testSystem.groundY,
                width: 60,
                height: 100,
                color: '#3498DB',
                canInteract: true,
                dialogue: 'æˆ‘æ˜¯æ–°åŠ å…¥çš„ NPCï¼'
            };
            window.testSystem.entities.push(npc);
            console.log('Added NPC:', npc);
        };

        window.testAddItem = function() {
            const item = {
                type: 'item',
                id: 'test_item_' + Date.now(),
                name: 'æ¸¬è©¦ç‰©å“',
                x: window.testSystem.player.x + 150,
                y: window.testSystem.groundY + 40,
                width: 40,
                height: 40,
                color: '#2ECC71',
                canPickup: true
            };
            window.testSystem.entities.push(item);
            console.log('Added Item:', item);
        };

        window.testCallPartner = function() {
            const partners = ['Donnie', 'Todd', 'Chase', 'Bello', 'Paul', 'Flip', 'Jerome'];
            const partner = partners[Math.floor(Math.random() * partners.length)];
            alert(`å‘¼å« ${partner} åŠ å…¥ï¼\nï¼ˆå¤¥ä¼´ç³»çµ±å¾…æ•´åˆå®Œæ•´ï¼‰`);

            // æ·»åŠ åˆ°å¤¥ä¼´åˆ—è¡¨
            const container = document.querySelector('.active-partners');
            const slot = document.createElement('div');
            slot.className = 'partner-slot';
            slot.innerHTML = `<div class="partner-avatar">âœˆï¸</div><span>${partner}</span>`;
            container.appendChild(slot);
        };

        window.testUseAbility = function() {
            alert('ä½¿ç”¨èƒ½åŠ›ï¼\næ•ˆæœ: é€Ÿåº¦æå‡ 50%');
        };

        window.testShowDialogue = function() {
            alert('å°è©±ç³»çµ±æ¸¬è©¦:\n\nMaria: ä½ å¥½ï¼æ­¡è¿ä¾†åˆ°å·´é»ï¼\næˆ‘éœ€è¦ä½ å¹«æˆ‘æ‰¾ä¸€äº›çƒ˜ç„™ææ–™ã€‚\n\n[æ¥å—ä»»å‹™] [ç¨å¾Œå†èªª]');
        };

        window.testCompleteMission = function() {
            alert('ğŸ‰ ä»»å‹™å®Œæˆï¼\n\nç²å¾—çå‹µ:\nğŸ’° é‡‘å¹£ +500\nâ­ ç¶“é©—å€¼ +200\nğŸ“¦ ç‰¹æ®Šç‰©å“ x1');
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const container = document.getElementById('game-container');
                window.testSystem = new TestExplorationSystem(container);
                window.testSystem.init();

                // éš±è—è¼‰å…¥ç•«é¢
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('test-controls').style.display = 'flex';
            }, 500);
        });
    </script>
</body>
</html>
